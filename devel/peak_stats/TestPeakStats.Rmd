---
title: "TestPeakStats"
author: "Davide Rambaldi"
date: "2025-01-16"
output: html_document
---

### SETUP

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = '~/Projects/nf-fragmentomics/devel/peak_stats')
```

```{r}
library(tibble)
library(dplyr)
library(ggplot2)
library(readr)
library(stringr)
library(jsonlite)
setwd("~/Projects/nf-fragmentomics/devel/peak_stats")
```

```{r}
source("../../bin/fragmentomics_peakStats.R")
```

### OPTIONS

```{r}
opt <- list(
  random.points = 10000,
  bg.limit.left = 50,
  bg.limit.right = 50,
  central.coverage.bp = 30,
  signal = "S1",
  target = "T1",
  source = "griffin"
)
```

### TEST MATRIX

Load test matrix:

```{r}
mfile <- "../../tests/input/matrix/CDX2_regions_matrix.gz"
```

```{r}
mdata <- read_matrix(mfile, opt)
```

```{r}
write_files(mdata$all, mdata$summary, mdata$stats, opt)
```

```{r}
plot_signal(mdata$summary, mdata$integration, mdata$stats, opt)
```


